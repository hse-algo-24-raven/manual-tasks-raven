# Задание №10
# Задача о максимальном потоке минимальной стоимости.

**Для выполнения задания рекомендуется установить [Плагин отображения диаграмм Markdown Preview Mermaid Support](https://marketplace.visualstudio.com/items?itemName=bierner.markdown-mermaid)**

## Задание
Для каждого варианта представлены условия задачи, в соответствии с которыми необходимо: 
1. Построить сеть с указанием пропускной способности дуг.
2. Построить остаточную сеть.
3. Определить максимальный поток методом поиска увеличивающих путей в остаточной сети.
4. Минимизировать стоимость максимального потока посредством поиска циклов отрицательной стоимости.
5. Оформить решение задачи по шагам с подробными комментариями, таблицами и диаграммами.
6. В ответе указать максимальную величину потока, минимальную стоимость транспортировки и сеть с указанием соответствующих локальных потоков.

Условия для каждого варианта расположены в файле task-10/task.md в ветке main репозитория manual-tasks. 

Решение задачи нужно оформить в формате Markdown в отдельном файле с названием <название_команды>.md, который добавить в каталог task-10 данного репозитория.

## Информация по Markdown разметке:
[Система верстки LaTeX, которую можно использовать для математических формул](https://grammarware.net/text/syutkin/MathInLaTeX.pdf)

[Рисуем диаграммы Mermaid.js в README-файлах GitHub](https://habr.com/ru/articles/652867/)

## Для выполнения задания необходимо:
1. Обновить ветку main в локальном репозитории (git pull).
2. От ветки main создать ветвь с названием <название_команды>-task-10.
3. В созданной ветке в каталог task-10 добавить файл с решением задачи с названием <название_команды>.md.
4. Зафиксировать изменения на ветке (git commit).
5. Отравить ветку с изменениями в репозиторий на Github (git push).
6. Создать на Github запрос на слияние (pull request), указав в качестве base-ветки main, в качестве compare-ветки <название_команды>-task-10.


## Постановка задачи
1. Дана сеть (взвешенный ориентированный граф) с источником s и стоком t.
2. Для каждой дуги определена пропускная способность и стоимость транспортировки.
3. Необходимо найти для указанной сети максимальный поток минимальной стоимости. 

## Пример решения задачи на поиск максимального потока в сети

Пропускная способность дуг сети и стоимость транспортировки указана в таблице.

| Дуги                                          | sa | sb | sc | ad | bd | cd | dt |
|:----------------------------------------------|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
| Пропускная способность p(e)                   | 3  | 4  | 5  | 3  | 4  | 5  | 10 |
| Стоимость транспортировки единицы потока c(e) | 4  | 3  | 1  | 1  | 3  | 2  | 2  |

### 1. Построим сеть с источником **s**, стоком **t** и указанными пропускными способностями дуг для поиска максимального потока.

```mermaid
graph LR
    s-->|3|a
    s-->|4|b
    s-->|5|c
    a-->|3|d
    b-->|4|d
    c-->|5|d
    d-->|10|t
```
Укажем начальный поток величиной 3 **s -> a -> d -> t**. Построим соответствующую остаточную сеть.

```mermaid
graph RL
    t-.->|7|d-.->|5|c-.->|5|s
    d-.->|4|b-.->|4|s
    s-->|3|a-->|3|d-->|3|t
```

### 2. Проведем поиск увеличивающего пути в остаточной сети
В остаточной сети найден увеличивающий путь t -> d -> b -> s. Минимальный вес дуг на этом пути равен 4.

Уменьшим вес дуг на найденном пути, дуги для которых вес стал нулевым удалим из остаточной сети.

```mermaid
graph RL
    t-.->|3|d-.->|5|c-.->|5|s
    s-->|3|a-->|3|d-->|7|t
    s-->|4|b-->|4|d
```

### 3. Продолжим поиск увеличивающего пути в остаточной сети
В остаточной сети найден увеличивающий путь t -> d -> c -> s. Минимальный вес дуг на этом пути равен.

Уменьшим вес дуг на найденном пути, дуги для которых вес стал нулевым удалим из остаточной сети.

```mermaid
graph LR
    s-->|3|a-->|3|d-->|10|t
    s-->|4|b-->|4|d
    s-->|3|c-->|3|d
    d-.->|2|c-.->|2|s
```

### 4. Продолжим поиск увеличивающего пути в остаточной сети

В остаточной сети не найдено увеличивающих путей, следовательно, алгоритм завершил работу и найденный поток величиной 10 является максимальным для данной сети.

```mermaid
graph LR
    s-->|3,3|a
    s-->|4,4|b
    s-->|3,5|c
    a-->|3,3|d
    b-->|4,4|d
    c-->|3,5|d
    d-->|10,10|t
```

### 5. Рассчитаем стоимость полученного максимального потока.

| Дуги                                          | sa | sb | sc | ad | bd | cd | dt | Итого  |
|:----------------------------------------------|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:------:|
| Пропускная способность p(e)                   | 3  | 4  | 5  | 3  | 4  | 5  | 10 |        |
| Локальный поток f(e)                          | 3  | 4  | 3  | 3  | 4  | 3  | 10 |        |
| Стоимость транспортировки единицы потока c(e) | 4  | 3  | 1  | 1  | 3  | 2  | 2  |        |
| Суммарная стоимость f(e)*c(e)                 | 12 | 12 | 3  | 3  | 12 | 6  | 20 | **68** |

Стоимость полученного потока составляет 68. 

### 6. Попробуем уменьшить стоимость потока для чего построим остаточную сеть.
Для каждого ребра остаточной сети укажем стоимость транспортировки единицы потока.

```mermaid
graph LR
    s-->|-4|a-->|-4|d-->|-2|t
    s-->|-3|b-->|-3|d
    s-->|-1|c-->|-2|d
    d-.->|2|c-.->|1|s
```

В остаточной сети найден ориентированный цикл отрицательной стоимости s -> a -> d -> c -> s (- 3 - 3 + 2 + 1 = -3). 

Найдем минимальный вес ребра в указанном цикле, изображенном **в остаточной сети с указанием величины потока**.  

```mermaid
graph LR
    s-->|3|a-->|3|d-->|10|t
    s-->|4|b-->|4|d
    s-->|3|c-->|3|d
    d-.->|2|c-.->|2|s
```

Минимальный вес ребра в цикле 2 - это неиспользованный резерв ребра c -> d.

Удалим найденный цикл - уменьшим на 2 вес всех ребер, входящих в цикл.

```mermaid
graph LR
    s-->|1|a-->|1|d-->|10|t
    s-->|4|b-->|4|d
    s-->|5|c-->|5|d
    d-.->|2|a-.->|2|s
```

### 6. Проведем повторный поиск цикла отрицательной стоимости в остаточной сети.
Скорректируем остаточную сеть с указанием стоимости транспортировки единицы потока.

```mermaid
graph LR
    s-->|-4|a-->|-1|d-->|-2|t
    s-->|-3|b-->|-3|d
    s-->|-1|c-->|-2|d
    d-.->|1|a-.->|4|s
```

В остаточной сети найден ориентированный цикл отрицательной стоимости s -> b -> d -> a -> s (- 3 - 3 + 4 + 1 = -1). 

Найдем минимальный вес ребра в указанном цикле, изображенном **в остаточной сети с указанием величины потока**.  

```mermaid
graph LR
    s-->|1|a-->|1|d-->|10|t
    s-->|4|b-->|4|d
    s-->|5|c-->|5|d
    d-.->|2|a-.->|2|s
```

Минимальный вес ребра в цикле 2 - это неиспользованный резерв ребер s -> a и a -> d.

Удалим найденный цикл - уменьшим на 2 вес всех ребер, входящих в цикл.

```mermaid
graph LR
    s-->|3|a-->|3|d-->|10|t
    s-->|2|b-->|2|d
    s-->|5|c-->|5|d
    d-.->|2|b-.->|2|s
```

### 7. Проведем повторный поиск цикла отрицательной стоимости в остаточной сети.
Скорректируем остаточную сеть с указанием стоимости транспортировки единицы потока.

```mermaid
graph LR
    s-->|-4|a-->|-1|d-->|-2|t
    s-->|-3|b-->|-3|d
    s-->|-1|c-->|-2|d
    d-.->|3|b-.->|3|s
```

В остаточной сети отсутствуют циклы отрицательной стоимости, следовательно, стоимость потока минимальна.

### 8. Рассчитаем стоимость полученного максимального потока.

| Дуги                                          | sa | sb | sc | ad | bd | cd | dt | Итого  |
|:----------------------------------------------|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:------:|
| Пропускная способность p(e)                   | 3  | 4  | 5  | 3  | 4  | 5  | 10 |        |
| Локальный поток f(e)                          | 3  | 2  | 5  | 3  | 2  | 5  | 10 |        |
| Стоимость транспортировки единицы потока c(e) | 4  | 3  | 1  | 1  | 3  | 2  | 2  |        |
| Суммарная стоимость f(e)*c(e)                 | 12 | 6  | 5  | 3  | 6  | 10 | 20 | **62** |

Стоимость полученного потока составляет 62. 

### Ответ:
Максимальный поток в сети равен 10, минимальная стоимость потока 62, она реализуется следующим локальными потоками:

```mermaid
graph LR
    s-->|3,3|a
    s-->|2,4|b
    s-->|5,5|c
    a-->|3,3|d
    b-->|2,4|d
    c-->|5,5|d
    d-->|10,10|t
```
