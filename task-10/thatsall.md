## Вариант 2

| Дуги                   | sa | sс | ab | ad | ac | cd | bd | dt |
|------------------------|----|----|----|----|----|----|----|----|
| Пропускная способность p(e) | 10 | 10 | 6  | 6  | 6  | 12 | 6  | 12 |
| Стоимость транспортировки единицы потока c(e) | 2  | 1  | 1  | 3  | 1  | 5  | 1  | 2  |

## 1. Построим сеть с источником s, стоком t и указанными пропускными способностями дуг для поиска максимального потока.

```mermaid
graph LR
    s-->|10|a
    s-->|10|c
    a-->|6|c
    c-->|12|d
    a-->|6|d
    a-->|6|b
    b-->|6|d
    d-->|12|t
```

Укажем начальный поток величиной 10 s -> c -> d -> t. Построим соответствующую остаточную сеть.

```mermaid
graph RL
    t-.->|2|d
    d-->|10|t
    d-.->|6|b
    d-.->|6|a
    d-.->|2|c
    c-->|10|d
    c-.->|6|a
    a-.->|10|s
    s-->|10|c
    b-.->|6|a
```

## 2. Проведем поиск увеличивающего пути в остаточной сети

В остаточной сети найден увеличивающий путь t -> d -> b -> a -> s. Минимальный вес дуг на этом пути равен 2.

Уменьшим вес дуг на найденном пути, дуги для которых вес стал нулевым удалим из остаточной сети.

```mermaid
graph RL
    d-->|12|t
    d-.->|4|b
    d-.->|6|a
    d-.->|2|c
    c-->|10|d
    c-.->|6|a
    a-.->|8|s
    a-.->|2|b
    s-->|10|c
    s-->|2|a
    b-.->|4|a
    b-->|2|d
```

## 3. Продолжим поиск увеличивающего пути в остаточной сети

В остаточной сети не найдено увеличивающих путей, следовательно, алгоритм завершил работу и найденный поток величиной 12 является максимальным для данной сети.

```mermaid
graph LR
    s-->|2,10|a
    s-->|10,10|c
    a-->|0,6|c
    a-->|2,6|b
    a-->|0,6|d
    c-->|10,12|d
    b-->|2,6|d
    d-->|12,12|t
```

## 4. Рассчитаем стоимость полученного максимального потока

| Дуги                                      | sa | sc | ab | ad | ac | cd | bd | dt | Итого |
|------------------------------------------|----|----|----|----|----|----|----|----|-------|
| Пропускная способность p(e)              | 10 | 10 | 6  | 6  | 6  | 12 | 6  | 12 |       |
| Локальный поток f(e)                     | 2  | 10 | 2  | 0  | 0  | 10 | 2  | 12 |       |
| Стоимость транспортировки единицы потока c(e)| 2  | 1  | 1  | 3  | 1  | 5  | 1  | 2  |       |
| Суммарная стоимость f(e)*c(e)            | 4  | 10 | 2  | 0  | 0  | 50 | 2  | 24 | 92    |

## 5. Попробуем уменьшить стоимость потока для чего построим остаточную сеть

Для каждого ребра остаточной сети укажем стоимость транспортировки единицы потока.

```mermaid
graph LR
    s-->|-2|a
    s-->|-1|c
    a-.->|+2|s
    a-->|-1|b
    b-.->|+1|a
    b-->|-1|d
    c-.->|+1|a
    c-->|-5|d
    d-.->|+5|c
    d-.->|+3|a
    d-.->|+1|b
    d-->|-2|t
```

В остаточной сети найден ориентированный цикл отрицательной стоимости s -> c -> d -> b -> a -> s (- 1 - 5 + 1 + 1 + 2 = -3)

Минимальный вес ребра в цикле 4 - это неиспользованный резерв рёбер b -> d и a -> b.

Удалим найденный цикл - уменьшим на 4 вес всех ребер, входящих в цикл.

```mermaid
graph LR
    s-->|6|a
    s-->|6|c
    a-.->|4|s
    a-->|6|b
    b-->|6|d
    c-.->|4|s
    c-.->|6|a
    c-->|6|d
    d-.->|6|c
    d-.->|6|a
    d-->|12|t
```

## 6. Проведем повторный поиск цикла отрицательной стоимости в остаточной сети

Скорректируем остаточную сеть с указанием стоимости транспортировки единицы потока.

```mermaid
graph LR
    s-->|-2|a
    s-->|-1|c
    a-.->|+2|s
    a-->|-1|b
    b-->|-1|d
    c-.->|+1|s
    c-.->|+1|a
    c-->|-5|d
    d-.->|+5|c
    d-.->|+1|a
    d-->|-2|t
```

В остаточной сети найден ориентированный цикл отрицательной стоимости s -> c -> d -> a -> s (- 1 - 5 + 1 + 2 = -3).

Минимальный вес ребра в цикле 4 - это неиспользованный резерв ребра s -> a.

Удалим найденный цикл - уменьшим на 4 вес всех ребер, входящих в цикл.

```mermaid
graph LR
    s-->|10|a
    s-->|2|c
    a-->|4|d
    a-->|6|b
    b-->|6|d
    c-.->|8|s
    c-.->|6|a
    c-->|2|d
    d-.->|10|c
    d-.->|2|a
    d-->|12|t
```

## 7. Проведем повторный поиск цикла отрицательной стоимости в остаточной сети

Скорректируем остаточную сеть с указанием стоимости транспортировки единицы потока.

```mermaid
graph LR
    s-->|-2|a
    s-->|-1|c
    a-->|-1|d
    a-->|-1|b
    b-->|-1|d
    c-.->|+1|s
    c-.->|+1|a
    c-->|-5|d
    d-.->|-5|c
    d-.->|+1|a
    d-->|-2|t
```

В остаточной сети отсутствуют циклы отрицательной стоимости, следовательно, стоимость потока минимальна.

## 8. Рассчитаем стоимость полученного максимального потока

| Дуги                                      | sa | sc | ab | ad | ac | cd | bd | dt | Итого |
|------------------------------------------|----|----|----|----|----|----|----|----|-------|
| Пропускная способность p(e)              | 10 | 10 | 6  | 6  | 6  | 12 | 6  | 12 |       |
| Локальный поток f(e)                     | 10  | 2  | 6  | 4  | 0  | 2  | 6  | 12 |       |
| Стоимость транспортировки единицы потока c(e)| 2  | 1  | 1  | 3  | 1  | 5  | 1  | 2  |       |
| Суммарная стоимость f(e)*c(e)            | 20 | 2  | 6  | 12 | 1  | 10 | 6  | 24 | 81    |

## Ответ:

Максимальный поток в сети равен 12, минимальная стоимость потока 81, она реализуется следующим локальными потоками:

```mermaid
graph LR
    s-->|10,10|a
    s-->|2,10|c
    a-->|0,6|c
    a-->|6,6|b
    a-->|4,6|d
    b-->|6,6|d
    c-->|2,12|d
    d-->|12,12|t
```

