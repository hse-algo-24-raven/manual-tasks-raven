## ВАРИАНТ 5

Пропускная способность дуг сети и стоимость транспортировки указана в таблице.

| Дуги                      | sa | sb | sc | ba | bc | cd | ac | ad | dt |
|:--------------------------|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
| Пропускная способность    | 6  | 6  | 6  | 6  | 5  | 10 | 5  | 8  | 15 |
| Стоимость транспортировки | 2  | 2  | 4  | 1  | 1  | 1  | 3  | 4  | 3  |

### 1. Построим сеть с источником **s**, стоком **t** и указанными пропускными способностями дуг для поиска максимального потока.

```mermaid
graph LR
    S-->|6|a
    S-->|6|b
    S-->|6|c
    a-->|5|c
    a-->|8|d
    b-->|6|a
    b-->|5|c
    b-->|4|d
    c-->|10|d
    d-->|15|t
```

Построим остаточную сеть:


```mermaid
graph RL
    t-.->|15|d-.->|10|c-.->|5|a-.->|6|b-.->|6|S
    d-.->|8|a-.->|6|S
    c-.->|5|b
    c-.->|6|S

```

### 2. Проведем поиск увеличивающего пути в остаточной сети
В остаточной сети найден увеличивающий путь: **t -> d -> c -> S**. Минимальный вес дуг на этом пути равен 6.

Уменьшим вес дуг на найденном пути, дуги для которых вес стал нулевым удалим из остаточной сети (дуга c-.->S).

```mermaid
graph RL
    t-.->|9|d-.->|4|c-.->|5|a-.->|6|b-.->|6|S
    d-.->|8|a-.->|6|S
    c-.->|5|b
    S-->|6|c-->|6|d-->|6|t
```

### 3. Продолжим поиск увеличивающего пути в остаточной сети
В остаточной сети найден увеличивающий путь: **t -> d -> a -> S**. Минимальный вес дуг на этом пути равен 6.

Уменьшим вес дуг на найденном пути, дуги для которых вес стал нулевым удалим из остаточной сети (дуга a-.->S).

```mermaid
graph LR
    S-->|6|a
    S-->|6|c
    a-.->|6|b
    a-->|6|d
    b-.->|6|S
    c-.->|5|a
    c-->|6|d
    c-.->|5|b
    d-.->|2|a
    d-.->|4|c
    d-->|12|t
    t-.->|3|d
```

### 4. Продолжим поиск увеличивающего пути в остаточной сети
В остаточной сети найден увеличивающий путь: **t -> d -> c -> b -> S**. Минимальный вес дуг на этом пути равен 3.

Уменьшим вес дуг на найденном пути, дуги для которых вес стал нулевым удалим из остаточной сети (дуга t-.->d).


```mermaid
graph LR
    S-->|6|a
    S-->|3|b
    S-->|6|c
    a-.->|6|b
    a-->|6|d
    b-.->|3|S
    b-->|3|c
    c-.->|5|a
    c-.->|2|b
    c-->|9|d
    d-.->|2|a
    d-.->|1|c
    d-->|15|t
```


### 5. Продолжим поиск увеличивающего пути в остаточной сети

В остаточной сети не найдено увеличивающих путей, следовательно, алгоритм завершил работу и найденный поток величиной 15 является максимальным для данной сети.

```mermaid
graph LR
    s-->|6,6|a
    s-->|3,6|b
    s-->|6,6|c
    a-->|0,5|c
    a-->|6,8|d
    b-->|0,6|a
    b-->|3,5|c
    c-->|9,10|d
    d-->|15,15|t
```

### 6. Рассчитаем стоимость полученного максимального потока.

Дуги                                            | sa | sb | sc | ba | bc | cd | ac | ad | dt | Итого  |
|:----------------------------------------------|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:------:|
| Пропускная способность p(e)                   | 6  | 6  | 6  | 6  | 5  | 10 | 5  | 8  | 15 |        |
| Локальный поток f(e)                          | 6  | 3  | 6  | 0  | 3  | 9  | 0  | 6  | 15 |        |
| Стоимость транспортировки единицы потока c(e) | 2  | 2  | 4  | 1  | 1  | 1  | 3  | 4  | 3  |        |
| Суммарная стоимость f(e)*c(e)                 | 12 | 6  | 24 | 0  | 3  | 9  | 0  | 24 | 45 | **123**|

Стоимость полученного потока составляет **123**.

### 7. Попробуем уменьшить стоимость потока для чего построим остаточную сеть.
Для каждого ребра остаточной сети укажем стоимость транспортировки единицы потока.


```mermaid
graph LR
    S-->|-2|a
    S-->|-2|b
    S-->|-4|c
    a-.->|1|b
    a-->|-4|d
    b-.->|2|S
    b-->|-1|c
    c-.->|3|a
    c-.->|1|b
    c-->|-1|d
    d-.->|-4|a
    d-.->|1|c
    d-->|-3|t    
```

В остаточной сети найден ориентированный цикл отрицательной стоимости s -> c -> b -> s (- 4 + 1 + 2 = -1).

Найдем минимальный вес ребра в указанном цикле, изображенном **в остаточной сети с указанием величины потока**.

```mermaid
graph LR
    S-->|6|a
    S-->|3|b
    S-->|6|c
    a-.->|6|b
    a-->|6|d
    b-.->|3|S
    b-->|3|c
    c-.->|5|a
    c-.->|2|b
    c-->|9|d
    d-.->|2|a
    d-.->|1|c
    d-->|15|t
```

Минимальный вес ребра в цикле 2 - это неиспользованный резерв ребра c -> b.

Удалим найденный цикл - уменьшим на 2 вес всех ребер, входящих в цикл.

```mermaid
graph LR
    S-->|6|a
    S-->|5|b
    S-->|4|c
    a-.->|6|b
    a-->|6|d
    b-.->|1|S
    b-->|5|c
    c-.->|2|S
    c-.->|5|a
    c-->|9|d
    d-.->|2|a
    d-.->|1|c
    d-->|15|t
```

### 8. Проведем повторный поиск цикла отрицательной стоимости в остаточной сети.
Скорректируем остаточную сеть с указанием стоимости транспортировки единицы потока.

```mermaid
graph LR
    S-->|-2|a
    S-->|-2|b
    S-->|-4|c
    a-.->|1|b
    a-->|-4|d
    b-.->|2|S
    b-->|-1|c
    c-.->|4|S
    c-.->|3|a
    c-->|-1|d
    d-.->|4|a
    d-.->|1|c
    d-->|-3|t
```

В остаточной сети найден ориентированный цикл отрицательной стоимости S -> a -> d -> c -> S (- 2 - 4 + 1 + 4 = -1).

Найдем минимальный вес ребра в указанном цикле, изображенном **в остаточной сети с указанием величины потока**.

```mermaid
graph LR
    S-->|6|a
    S-->|5|b
    S-->|4|c
    a-.->|6|b
    a-->|6|d
    b-.->|1|S
    b-->|5|c
    c-.->|2|S
    c-.->|5|a
    c-->|9|d
    d-.->|2|a
    d-.->|1|c
    d-->|15|t
```

Минимальный вес ребра в цикле 1 - это неиспользованный резерв ребра d -> c.

Удалим найденный цикл - уменьшим на 1 вес всех ребер, входящих в цикл.

```mermaid
graph LR
    S-->|5|a
    S-->|5|b
    S-->|5|c
    a-.-|1|S
    a-.->|6|b
    a-->|5|d
    b-.->|1|S
    b-->|5|c
    c-.->|1|S
    c-.->|5|a
    c-->|10|d
    d-.->|3|a
    d-->|15|t
```

### 9. Проведем повторный поиск цикла отрицательной стоимости в остаточной сети.
Скорректируем остаточную сеть с указанием стоимости транспортировки единицы потока.

```mermaid
graph LR
    S-->|-2|a
    S-->|-2|b
    S-->|-4|c
    a-.-|2|S
    a-.->|1|b
    a-->|-4|d
    b-.->|2|S
    b-->|-1|c
    c-.->|4|S
    c-.->|3|a
    c-->|-1|d
    d-.->|4|a
    d-->|-3|t
```

В остаточной сети отсутствуют циклы отрицательной стоимости, следовательно, стоимость потока минимальна.

### 10. Рассчитаем стоимость полученного максимального потока.

Дуги                                            | sa | sb | sc | ba | bc | cd | ac | ad | dt | Итого  |
|:----------------------------------------------|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:------:|
| Пропускная способность p(e)                   | 6  | 6  | 6  | 6  | 5  | 10 | 5  | 8  | 15 |        |
| Локальный поток f(e)                          | 5  | 5  | 5  | 0  | 5  | 10 | 0  | 5  | 15 |        |
| Стоимость транспортировки единицы потока c(e) | 2  | 2  | 4  | 1  | 1  | 1  | 3  | 4  | 3  |        |
| Суммарная стоимость f(e)*c(e)                 | 10 | 10 | 20 | 0  | 5  | 10 | 0  | 20 | 45 | **120**|

Стоимость полученного потока составляет **120**.

### Ответ:
Максимальный поток в сети равен 15, минимальная стоимость потока 120, она реализуется следующим локальными потоками:

```mermaid
graph LR
    s-->|5,6|a
    s-->|5,6|b
    s-->|5,6|c
    a-->|0,5|c
    a-->|5,8|d
    b-->|0,6|a
    b-->|5,5|c
    c-->|10,10|d
    d-->|15,15|t
```