# Задание №9
# Задача о максимальном потоке.

**Для выполнения задания рекомендуется установить [Плагин отображения диаграмм Markdown Preview Mermaid Support](https://marketplace.visualstudio.com/items?itemName=bierner.markdown-mermaid)**

## Задание
Для каждого варианта представлены условия задачи, в соответствии с которыми необходимо: 
1. Построить сеть с указанием пропускной способности дуг.
2. Построить остаточную сеть.
3. Определить максимальный поток методом поиска увеличивающих путей в остаточной сети.
4. Проверить величину максимального потока через поиск минимальной пропускной способности разрезов сети, то есть рассчитать пропускную способность всех разрезов сети.
5. Оформить решение задачи по шагам с подробными комментариями, таблицами и диаграммами.
6. В ответе указать максимальную величину потока и как это поток можно организовать, то есть изобразить сеть с указанием соответствующих локальных потоков.

Условия для каждого варианта расположены в файле task-9/task.md в ветке main репозитория manual-tasks. 

Решение задачи нужно оформить в формате Markdown в отдельном файле с названием <название_команды>.md, который добавить в каталог task-9 данного репозитория.

## Информация по Markdown разметке:
[Система верстки LaTeX, которую можно использовать для математических формул](https://grammarware.net/text/syutkin/MathInLaTeX.pdf)

[Рисуем диаграммы Mermaid.js в README-файлах GitHub](https://habr.com/ru/articles/652867/)

## Для выполнения задания необходимо:
1. Обновить ветку main в локальном репозитории (git pull).
2. От ветки main создать ветвь с названием <название_команды>-task-9.
3. В созданной ветке в каталог task-9 добавить файл с решением задачи с названием <название_команды>.md.
4. Зафиксировать изменения на ветке (git commit).
5. Отравить ветку с изменениями в репозиторий на Github (git push).
6. Создать на Github запрос на слияние (pull request), указав в качестве base-ветки main, в качестве compare-ветки <название_команды>-task-9.

## Постановка задачи
1. Дана сеть (взвешенный ориентированный граф) с источником s и стоком t.
2. Для каждой дуги определена ее пропускная способность.
3. Необходимо найти максимальный поток для указанной сети. 

## Пример решения задачи на поиск максимального потока в сети

Пропускная способность дуг сети указана в таблице.

|          Дуги          | sa | sb | at | ac | bc | ba | ct |
|:----------------------:|:--:|:--:|:--:|:--:|:--:|----|----|
| Пропускная способность | 6  | 7  | 5  | 5  | 2  | 4  | 6  |

### 1. Построим сеть с источником **s**, стоком **t** b указанными пропускными способностями дуг.

```mermaid
graph LR
    s-->|6|a
    s-->|7|b
    b-->|4|a
    a-->|5|c
    a-->|5|t
    b-->|2|c
    c-->|6|t
```

Построим остаточную сеть. Так как изначально поток в сети не задан, все дуги сети являются пустыми (локальный поток равен нулю), соответственно в остаточную сеть необходимо вынести обратную дугу с весом равным пропускной способности. 

```mermaid
graph RL
    a-.->|6|s
    b-.->|7|s
    a-.->|4|b
    c-.->|5|a
    t-.->|5|a
    c-.->|2|b
    t-.->|6|c
```

### 2. Проведем поиск увеличивающего пути в остаточной сети
В остаточной сети найден увеличивающий путь t -> a -> s. Минимальный вес дуг на этом пути равен 5.

Уменьшим вес дуг на найденном пути, дуги для которых вес стал нулевым удалим из остаточной сети.

```mermaid
graph RL
    a-.->|1|s 
    s--->|5|a
    b-.->|7|s
    a-.->|4|b
    c-.->|5|a
    c-.->|2|b
    a--->|5|t
    t-.->|6|c
```

Скорректируем соответствующим образом локальные потоки в исходной сети. Первым числом будем указывать локальный поток, вторым пропускную способность дуги. 

```mermaid
graph LR
    s-->|"(5, 6)"|a
    s-->|"(0, 7)"|b
    b-->|"(0, 4)"|a
    a-->|"(0, 5)"|c
    a-->|"(5, 5)"|t
    b-->|"(0, 2)"|c
    c-->|"(0, 6)"|t
```

### 3. Продолжим поиск увеличивающего пути в остаточной сети

```mermaid
graph RL
    a-.->|1|s
    s--->|5|a
    b-.->|7|s
    a-.->|4|b
    c-.->|5|a
    c-.->|2|b
    a--->|5|t
    t-.->|6|c
```

В остаточной сети найден увеличивающий путь t -> c -> b -> s. Минимальный вес дуг на этом пути равен 2.

Уменьшим вес дуг на найденном пути, дуги для которых вес стал нулевым удалим из остаточной сети.

```mermaid
graph LR
    s--->|2|b
    a-.->|1|s
    s--->|5|a
    b-.->|5|s
    a-.->|4|b
    c-.->|5|a
    b--->|2|c
    a--->|5|t
    t-.->|4|c
    c--->|2|t
```

Скорректируем соответствующим образом локальные потоки в исходной сети.

```mermaid
graph LR
    s-->|"(5, 6)"|a
    s-->|"(2, 7)"|b
    b-->|"(0, 4)"|a
    a-->|"(0, 5)"|c
    a-->|"(5, 5)"|t
    b-->|"(2, 2)"|c
    c-->|"(2, 6)"|t
```

### 4. Продолжим поиск увеличивающего пути в остаточной сети

```mermaid
graph LR
    s--->|2|b
    a-.->|1|s
    s--->|5|a
    b-.->|5|s
    a-.->|4|b
    c-.->|5|a
    b--->|2|c
    a--->|5|t
    t-.->|4|c
    c--->|2|t
```

В остаточной сети найден увеличивающий путь t -> c -> a -> b -> s. Минимальный вес дуг на этом пути равен 4.

Уменьшим вес дуг на найденном пути, дуги для которых вес стал нулевым удалим из остаточной сети.

```mermaid
graph LR
    s--->|2|b
    a-.->|1|s
    s--->|5|a
    b-.->|1|s
    s--->|4|b
    b--->|4|a
    c-.->|1|a
    a-.->|4|c
    b--->|2|c
    a--->|5|t
    c--->|6|t
```

Скорректируем соответствующим образом локальные потоки в исходной сети.

```mermaid
graph LR
    s-->|"(5, 6)"|a
    s-->|"(6, 7)"|b
    b-->|"(4, 4)"|a
    a-->|"(4, 5)"|c
    a-->|"(5, 5)"|t
    b-->|"(2, 2)"|c
    c-->|"(6, 6)"|t
```

### 5. Продолжим поиск увеличивающего пути в остаточной сети
В остаточной сети не найдено увеличивающих путей, следовательно, алгоритм завершил работу и найденный поток величиной 11 является максимальным для данной сети.

### 6. Проверим значение максимального потока перебором всех разрезов сети.
Разрез сети - разбиение множества вершин на два подмножества V<sub>1</sub> и V<sub>2</sub>, где во множество V<sub>1</sub> входит источник, а в V<sub>2</sub> входит сток.

Пропускная способность разреза - сумма пропускной способности дуг, начинающихся в вершинах из множества V<sub>1</sub> и оканчивающихся в вершинах из V<sub>2</sub>.

Для сети из _n_ вершин существует 2<sup>n - 2</sup> различных разрезов, так как две вершины из множества (источник и сток) "зафиксированы" в V<sub>1</sub> и V<sub>2</sub>, остальные вершины можно различными способами распределять между множествами V<sub>1</sub> и V<sub>2</sub>.

Для сети из 5 вершин нужно найти 2<sup>5 - 2</sup> = 2<sup>3</sup> = 8 разрезов. 

| № | V<sub>1</sub>                   | V<sub>2</sub> | Пропускная способность разреза |
|---|:--------------------------------|:--------------|:------------------------------:|
| 1 | s                               | a, b, c, t    |           6 + 7 = 13           |
|   | **s + одна вершина из a, b, c** |               |                                |
| 2 | s, a                            | b, c, t       |         7 + 5 + 5 = 17         |
| 3 | s, b                            | a, c, t       |         6 + 4 + 2 = 12         |
| 4 | s, c                            | a, b, t       |         6 + 7 + 6 = 19         |
|   | **s + пара вершин из a, b, c**  |               |                                |
| 5 | s, a, b                         | c, t          |         5 + 5 + 2 = 12         |
| 6 | s, a, c                         | b, t          |         6 + 4 + 2 = 12         |
| 7 | s, b, c                         | a, t          |         7 + 5 + 6 = 18         |
|   | **s + три вершины из a, b, c**  |               |                                |
| 8 | s, a, b, c                      | t             |           5 + 6 = 11           |

Минимальная пропускная способность разреза равна 11 ( {s, a, b, c} / {t} ), что совпадает с найденной величиной максимального потока в сети.

### Ответ:
Максимальный поток в сети равен 11, он реализуется следующим локальными потоками:

```mermaid
graph LR
    s-->|"(5, 6)"|a
    s-->|"(6, 7)"|b
    b-->|"(4, 4)"|a
    a-->|"(4, 5)"|c
    a-->|"(5, 5)"|t
    b-->|"(2, 2)"|c
    c-->|"(6, 6)"|t
```
