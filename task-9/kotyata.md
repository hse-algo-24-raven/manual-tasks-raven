# Задание №9, вариант 8

# Задача о максимальном потоке

## Постановка задачи
1. Дана сеть (взвешенный ориентированный граф) с источником s и стоком t. 
2. Для каждой дуги определена ее пропускная способность:


|          Дуги          | sa | sb | sс | aс | ab | cb | at | bt |
|:----------------------:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
| Пропускная способность | 7  | 4  | 5  | 6  | 3  | 9  | 4  | 8  |

3. Необходимо найти максимальный поток для указанной сети. 

## Сеть 

Для начала построим сеть с источником *s* и стоком *t* с указанием пропускной способности дуг. 

```mermaid
graph LR
    s-->|7|a
    s-->|4|b
    s-->|5|c
    a-->|6|c
    a-->|3|b
    c-->|9|b
    a-->|4|t
    b-->|8|t
```

## Остаточная сеть

Построим остаточную сеть. Будем считать, что изначально локальный поток равен *0*.

```mermaid
graph RL
    a-.->|7|s
    b-.->|4|s
    c-.->|5|s
    c-.->|6|a
    b-.->|3|a
    b-.->|9|c
    t-.->|4|a
    t-.->|8|b
```

## Определение максимального потока методом поиска увеличивающих путей в остаточной сети.

### 1. 

Найдем увеличивающую цепь в остаточной сети: 

```mermaid
graph RL
    a-.->|7|s
    t-.->|4|a
```
Так как минимальный вес дуг в цепи равен *4*, добавим в остаточную сеть поток с той же мощностью.

Построим новую остаточную сеть:

```mermaid
graph RL
    a-.->|3|s
    b-.->|4|s
    c-.->|5|s
    c-.->|6|a
    b-.->|3|a
    b-.->|9|c
    t-.->|8|b
    s--->|4|a
    a--->|4|t      
```
### 2. 

Найдем следующую увеличивающую цепь в остаточной сети: 

```mermaid
graph RL
    t-.->|8|b
    b-.->|9|c
    c-.->|5|s
``` 

Минимальный вес дуг в цепи равен *5*.

Построим новую остаточную сеть:

```mermaid
graph LR
    a-.->|3|s
    b-.->|4|s
    c-.->|6|a
    b-.->|3|a
    b-.->|4|c
    t-.->|3|b
    s--->|4|a
    a--->|4|t
    s--->|5|c
    c--->|5|b
    b--->|5|t      
```
### 3. 

Найдем следующую увеличивающую цепь в остаточной сети: 

```mermaid
graph RL
    t-.->|3|b
    b-.->|4|s
``` 

Минимальный вес дуг в цепи равен *3*.

Построим новую остаточную сеть:

```mermaid
graph LR
    a-.->|3|s
    b-.->|1|s
    c-.->|6|a
    b-.->|3|a
    s--->|4|a
    a--->|4|t
    s--->|5|c
    c--->|5|b
    b--->|8|t  
    s--->|3|b 
```

Так как в сети нет ни одного ориентированного пути из *t* в *s*, то добавить новые потоки нельзя.

## Итоговая конфигурация сети

```mermaid
graph LR
    s-->|"(4, 7)"|a
    s-->|"(3, 4)"|b
    s-->|"(5, 5)"|c
    a-->|"(0, 6)"|c
    a-->|"(0, 3)"|b
    c-->|"(5, 9)"|b
    a-->|"(4, 4)"|t
    b-->|"(8, 8)"|t
```

Максимальный поток в сети равен *12*.

## Проверим значение максимального потока перебором всех разрезов сети.

| № | V<sub>1</sub>                   | V<sub>2</sub> | Пропускная способность разреза |
|---|:--------------------------------|:--------------|:------------------------------:|
| 1 | s                               | a, b, c, t    |         7 + 4 + 5 = 16         |
| 2 | s, a                            | b, c, t       |     4 + 3 + 6 + 4 + 5 = 22     |
| 3 | s, b                            | a, c, t       |         7 + 5 + 8 = 20         |
| 4 | s, c                            | a, b, t       |         7 + 4 + 9 = 20         |
| 5 | s, a, b                         | c, t          |       5 + 4 + 6 + 8 = 23       |
| 6 | s, a, c                         | b, t          |       4 + 4 + 3 + 9 = 20       |
| 7 | s, b, c                         | a, t          |           7 + 8 = 15           |
| 8 | s, a, b, c                      | t             |           4 + 8 = 12           |

Минимальная пропускная способность разреза равна 12 ( {s, a, b, c} | {t} ), что совпадает с найденной величиной максимального потока в сети.